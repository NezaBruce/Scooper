// import React, { useState, useEffect } from 'react';
// import { submitComment } from '../services';

// const CommentsForm = ({ slug }) => {
//   const [error, setError] = useState(false);
//   const [localStorage, setLocalStorage] = useState(null);
//   const [showSuccessMessage, setShowSuccessMessage] = useState(false);
//   const [formData, setFormData] = useState({ name: null, email: null, comment: null, storeData: false });

//   useEffect(() => {
//     setLocalStorage(window.localStorage);
//     const initalFormData = {
//       name: window.localStorage.getItem('name'),
//       email: window.localStorage.getItem('email'),
//       storeData: window.localStorage.getItem('name') || window.localStorage.getItem('email'),
//     };
//     setFormData(initalFormData);
//   }, []);

//   const onInputChange = (e) => {
//     const { target } = e;
//     if (target.type === 'checkbox') {
//       setFormData((prevState) => ({
//         ...prevState,
//         [target.name]: target.checked,
//       }));
//     } else {
//       setFormData((prevState) => ({
//         ...prevState,
//         [target.name]: target.value,
//       }));
//     }
//   };

//   const handlePostSubmission = () => {
//     setError(false);
//     const { name, email, comment, storeData } = formData;
//     if (!name || !email || !comment) {
//       setError(true);
//       return;
//     }
//     const commentObj = {
//       name,
//       email,
//       comment,
//       slug,
//     };

//     if (storeData) {
//       localStorage.setItem('name', name);
//       localStorage.setItem('email', email);
//     } else {
//       localStorage.removeItem('name');
//       localStorage.removeItem('email');
//     }

//     submitComment(commentObj)
//       .then((res) => {
//         if (res.createComment) {
//           if (!storeData) {
//             formData.name = '';
//             formData.email = '';
//           }
//           formData.comment = '';
//           setFormData((prevState) => ({
//             ...prevState,
//             ...formData,
//           }));
//           setShowSuccessMessage(true);
//           setTimeout(() => {
//             setShowSuccessMessage(false);
//           }, 3000);
//         }
//       });
//   };

//   return (
//     <div className="bg-white shadow-lg rounded-lg p-8 pb-12 mb-8">
//       <h3 className="text-xl mb-8 font-semibold border-b pb-4">Leave a Reply</h3>
//       <div className="grid grid-cols-1 gap-4 mb-4">
//         <textarea value={formData.comment} onChange={onInputChange} className="p-4 outline-none w-full rounded-lg h-40 focus:ring-2 focus:ring-gray-200 bg-gray-100 text-gray-700" name="comment" placeholder="Comment" />
//       </div>
//       <div className="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
//         <input type="text" value={formData.name} onChange={onInputChange} className="py-2 px-4 outline-none w-full rounded-lg focus:ring-2 focus:ring-gray-200 bg-gray-100 text-gray-700" placeholder="Name" name="name" />
//         <input type="email" value={formData.email} onChange={onInputChange} className="py-2 px-4 outline-none w-full rounded-lg focus:ring-2 focus:ring-gray-200 bg-gray-100 text-gray-700" placeholder="Email" name="email" />
//       </div>
//       <div className="grid grid-cols-1 gap-4 mb-4">
//         <div>
//           <input checked={formData.storeData} onChange={onInputChange} type="checkbox" id="storeData" name="storeData" value="true" />
//           <label className="text-gray-500 cursor-pointer" htmlFor="storeData"> Save my name, email in this browser for the next time I comment.</label>
//         </div>
//       </div>
//       {error && <p className="text-xs text-red-500">All fields are mandatory</p>}
//       <div className="mt-8">
//         <button type="button" onClick={handlePostSubmission} className="transition duration-500 ease hover:bg-indigo-900 inline-block bg-pink-600 text-lg font-medium rounded-full text-white px-8 py-3 cursor-pointer">Post Comment</button>
//         {showSuccessMessage && <span className="text-xl float-right font-semibold mt-3 text-green-500">Comment submitted for review</span>}
//       </div>
//     </div>
//   );
// };

// export default CommentsForm;



// export const submitComment = async (obj) => {
//   const result = await fetch('/api/comments', {
//     method: 'POST',
//     headers: {
//       'Content-Type': 'application/json',
//     },
//     body: JSON.stringify(obj),
//   });

//   return result.json();
// };

// export const getComments = async (slug) => {
//   const query = gql`
//     query GetComments($slug:String!) {
//       comments(where: {post: {slug:$slug}}){
//         name
//         createdAt
//         comment
//       }
//     }
//   `;

//   const result = await request(graphqlAPI, query, { slug });

//   return result.comments;
// };












// import { GraphQLClient, gql } from 'graphql-request';

// const graphqlAPI = process.env.NEXT_PUBLIC_GRAPHCMS_ENDPOINT;

// /** *************************************************************
// * Any file inside the folder pages/api is mapped to /api/* and  *
// * will be treated as an API endpoint instead of a page.         *
// *************************************************************** */

// // export a default function for API route to work
// // export default async function asynchandler(req, res) {
// //   const graphQLClient = new GraphQLClient((graphqlAPI), {
// //     headers: {
// //       authorization: `Bearer ${process.env.GRAPHCMS_TOKEN}`,
// //     },
// //   });
// //   const query = gql`
// //     mutation CreateComment($name: String!, $email: String!, $comment: String!, $slug: String!) {
// //       createComment(data: {name: $name, email: $email, comment: $comment, post: {connect: {slug: $slug}}}) { id }
// //     }
// //   `;

// //   const result = await graphQLClient.request(query, {
// //     name: req.body.name,
// //     email: req.body.email,
// //     comment: req.body.comment,
// //     slug: req.body.slug,
// //   });

// //   return res.status(200).send(result);
// // }
// import React from 'react';
// import moment from 'moment';
// import Link from 'next/link';

// const AdjacentPostCard = ({ post, position }) => (
//   <>
//     <div className="absolute rounded-lg bg-center bg-no-repeat bg-cover shadow-md inline-block w-full h-72" style={{ backgroundImage: `url('${post.featuredImage.url}')` }} />
//     <div className="absolute rounded-lg bg-center bg-gradient-to-b opacity-50 from-gray-400 via-gray-700 to-black w-full h-72" />
//     <div className="flex flex-col rounded-lg p-4 items-center justify-center absolute w-full h-full">
//       <p className="text-white text-shadow font-semibold text-xs">{moment(post.createdAt).format('MMM DD, YYYY')}</p>
//       <p className="text-white text-shadow font-semibold text-2xl text-center">{post.title}</p>
//     </div>
//     <Link href={`/post/${post.slug}`}><span className="z-10 cursor-pointer absolute w-full h-full" /></Link>
//     {position === 'LEFT' && (
//       <div className="absolute arrow-btn bottom-5 text-center py-3 cursor-pointer bg-pink-600 left-4 rounded-full">
//         <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-white w-full" fill="none" viewBox="0 0 24 24" stroke="currentColor">
//           <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
//         </svg>
//       </div>
//     )}
//     {position === 'RIGHT' && (
//       <div className="absolute arrow-btn bottom-5 text-center py-3 cursor-pointer bg-pink-600 right-4 rounded-full">
//         <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-white w-full" fill="none" viewBox="0 0 24 24" stroke="currentColor">
//           <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
//         </svg>
//       </div>
//     )}
//   </>
// );

// // export default AdjacentPostCard;
// import React from 'react';
// import { useRouter } from 'next/router';

// import { getCategories, getCategoryPost } from '../../services';
// import { PostCard, Categories, Loader } from '../../components';

// const CategoryPost = ({ posts }) => {
//   const router = useRouter();

//   if (router.isFallback) {
//     return <Loader />;
//   }

//   return (
//     <div className="container mx-auto px-10 mb-8">
//       <div className="grid grid-cols-1 lg:grid-cols-12 gap-12">
//         <div className="col-span-1 lg:col-span-8">
//           {posts.map((post, index) => (
//             <PostCard key={index} post={post.node} />
//           ))}
//         </div>
//         <div className="col-span-1 lg:col-span-4">
//           <div className="relative lg:sticky top-8">
//             <Categories />
//           </div>
//         </div>
//       </div>
//     </div>
//   );
// };
// export default CategoryPost;

// // Fetch data at build time
// export async function getStaticProps({ params }) {
//   const posts = await getCategoryPost(params.slug);

//   return {
//     props: { posts },
//   };
// }

// // Specify dynamic routes to pre-render pages based on data.
// // The HTML is generated at build time and will be reused on each request.
// export async function getStaticPaths() {
//   const categories = await getCategories();
//   return {
//     paths: categories.map(({ slug }) => ({ params: { slug } })),
//     fallback: true,
//   };
// }






























// import React, { useState, useEffect } from 'react';

// import { AdjacentPostCard } from '../components';
// import { getAdjacentPosts } from '../services';

// const AdjacentPosts = ({ createdAt, slug }) => {
//   const [adjacentPost, setAdjacentPost] = useState(null);
//   const [dataLoaded, setDataLoaded] = useState(false);

//   useEffect(() => {
//     getAdjacentPosts(createdAt, slug).then((result) => {
//       setAdjacentPost(result);
//       setDataLoaded(true);
//     });
//   }, [slug]);

//   return (
//     <div className="grid grid-cols-1 lg:grid-cols-8 gap-12 mb-8">
//       {dataLoaded && (
//         <>
//           {adjacentPost.previous && (
//             <div className={`${adjacentPost.next ? 'col-span-1 lg:col-span-4' : 'col-span-1 lg:col-span-8'} adjacent-post rounded-lg relative h-72`}>
//               <AdjacentPostCard post={adjacentPost.previous} position="LEFT" />
//             </div>
//           )}
//           {adjacentPost.next && (
//             <div className={`${adjacentPost.previous ? 'col-span-1 lg:col-span-4' : 'col-span-1 lg:col-span-8'} adjacent-post rounded-lg relative h-72`}>
//               <AdjacentPostCard post={adjacentPost.next} position="RIGHT" />
//             </div>
//           )}
//         </>
//       )}
//     </div>
//   );
// };

// export default AdjacentPosts;